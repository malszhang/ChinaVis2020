<html>

<head>
  <title>elementUi</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <!-- 引入样式 -->
  <link rel="stylesheet" href="../lib/elementui/theme-chalk/index.css" type="text/css">
  <link rel="stylesheet" href="../css/init.css" type="text/css">
  <link rel="stylesheet" href="../css/theme.css" type="text/css">
</head>

<body>
  <div id="app">

    <el-row :gutter="8">
      <el-col :span="4" style="height: 70%;">
        <el-row>
          <div class="grid-content-header grid-content2 bg-purple" id="topicStudy"></div>
        </el-row>
        <el-row>
          <div class="grid-content-header grid-content2 bg-purple" id="topicWork"></div>
        </el-row>
      </el-col>
      <el-col :span="20">
        <div class="grid-content-header grid-content3 bg-purple" id="sankeyChart"></div>
      </el-col>
    </el-row>
    <el-row :gutter="8" style="height: 27%; margin-bottom: 10px;">
      <el-col :span="6">
        <div class="grid-content-header grid-content1 bg-purple" id="bar"></div>
      </el-col>
      <el-col :span="12">
        <div class="grid-content-header grid-content1 bg-purple" id="parallelChart"></div>
      </el-col>
      <el-col :span="6">
        <div class="grid-content-header grid-content1 bg-purple" id="fTotal"></div>
      </el-col>
    </el-row>
  </div>
  <style>
    body {
      margin: 5px;
    }

    #app {
      height: 100%;
      width: 100%;
    }

    .el-row {
      margin-bottom: 10px;
    }

    .el-col {
      border-radius: 4px;
    }

    .bg-purple {
      background: #ffffff;
    }

    .grid-content1 {
      border-radius: 4px;
      min-height: 100%;
    }

    .grid-content2 {
      border-radius: 4px;
      min-height: 49%;
    }

    .grid-content3 {
      border-radius: 4px;
      min-height: 70%;
    }

    .row-bg {
      padding: 10px 0;
      background-color: #f9fafc;
    }
  </style>
  <!-- 引入组件库 -->
  <script type="text/javascript" src="../lib/vue.js"></script>
  <script type="text/javascript" src="../lib/elementui/index.js"></script>
  <script type="text/javascript" src="../lib/jquery.js"></script>
  <script type="text/javascript" src="../lib/echarts.min.js"></script>
  <script type="text/javascript" src="../lib/d3.v4.min.js"></script>
  <script type="text/javascript" src="../lib/d3-sanKey.js"></script>
  <script type="text/javascript" src="../js_draw/eAnalyst/sankey.js"></script>
  <script type="text/javascript" src="../js_draw/eAnalyst/parallel.js"></script>
  <!-- <script type="text/javascript" src="../js_draw/eAnalyst/drawStair.js"></script> -->
  <script type="text/javascript">
    new Vue({
      el: "#app",
      mounted() {
        $.get('data/复工复学2.json', function (data) {

          var time = [];
          var para_data = [];
          for (let i = 0; i < data.nodes.length; ++i) {
            var json = {};
            json['title'] = data.nodes[i].title;
            json['theme'] = data.nodes[i].theme;
            json['emotion'] = data.nodes[i].emotion;
            var keys = Object.keys(data.nodes[i]);
            for (let j = 6; j < 10; ++j) {
              json[keys[j]] = data.nodes[i][keys[j]];
            }
            
            para_data.push(json);
            time.push(data.nodes[i].date);
          }
          drawSankey(data, time);
          drawParallel(para_data);
          // for (let i = 0; i < data.nodes.length; ++i) {
          //   data.nodes[i].name = data.nodes[i].title;
          // }

          // for (let i = 0; i < data.nodes.length; ++i) {
          //   data.links[i].source = data.nodes[data.links[i].source].title;
          //   data.links[i].target = data.nodes[data.links[i].target].title;
          // }

          // 

          // let sankeyDOM = document.getElementById('sankeyChart');

          // let sankeyChart = echarts.init(sankeyDOM);
          // sankeyChart.setOption(option = {
          //   title: {
          //     text: 'Sankey Diagram'
          //   },
          //   tooltip: {
          //     trigger: 'item',
          //     triggerOn: 'mousemove'
          //   },
          //   series: [{
          //     type: 'sankey',
          //     data: data.nodes,
          //     links: data.links,
          //     focusNodeAdjacency: 'allEdges',
          //     left: '3%',
          //     right: '3%',
          //     itemStyle: {
          //       color: function (params) {
          //         console.log(params.data);
          //         if (params.data.theme == '复学&复工') {
          //           return 'rgb(0,128,0)';
          //         }
          //         if (params.data.emotion == 1) {
          //           return 'rgb(255,0,0)';
          //         }
          //         return 'rgb(0,0,255)';
          //       },
          //       borderWidth: 1,
          //       borderColor: '#aaa'
          //     },
          //     lineStyle: {
          //       color: 'source',
          //       curveness: 0.5
          //     },
          //     label: {
          //       show: false,
          //     },
          //   }]
          // });
        });
      }
    });
  </script>
</body>

</html>